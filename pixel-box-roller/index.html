<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="icon.png" type="image/png">
    <title>Pixel Box Roller</title>
    <style>
        body {
            background-color: #1a1a2e;
            color: #e6e6e6;
            font-family: 'Courier New', monospace;
            margin: 0;
            padding: 20px;
            image-rendering: pixelated;
            image-rendering: -moz-crisp-edges;
            image-rendering: crisp-edges;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            border: 4px solid #4a4a6a;
            background-color: #2a2a3a;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        h1 {
            text-align: center;
            color: #ffcc00;
            text-shadow: 3px 3px 0 #aa8800;
            font-size: 32px;
            margin-bottom: 30px;
        }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            background-color: #333344;
            padding: 10px;
            border: 2px solid #4a4a6a;
            margin-bottom: 20px;
        }

        .stat {
            display: flex;
            align-items: center;
        }

        .stat-icon {
            width: 24px;
            height: 24px;
            margin-right: 8px;
            font-size: 20px;
        }

        .game-area {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }

        .roll-section {
            flex: 1;
            min-width: 300px;
            background-color: #333344;
            padding: 15px;
            border: 2px solid #4a4a6a;
        }

        .inventory-section {
            flex: 1;
            min-width: 300px;
            background-color: #333344;
            padding: 15px;
            border: 2px solid #4a4a6a;
            max-height: 400px;
            overflow-y: auto;
        }

        .upgrades-section {
            flex: 100%;
            background-color: #333344;
            padding: 15px;
            border: 2px solid #4a4a6a;
            margin-top: 20px;
        }

        .box {
            width: 100px;
            height: 100px;
            background-color: #8b4513;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 40px;
            border: 4px solid #5a2c00;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .box:hover {
            transform: scale(1.05);
        }

        .box:active {
            transform: scale(0.95);
        }

        .box::before {
            content: "";
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(45deg, #ffcc00, #ff9900, #ffcc00);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .box:hover::before {
            opacity: 0.3;
        }

        .roll-button {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 20px 0;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-bottom: 4px solid #2d682f;
            font-family: 'Courier New', monospace;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .roll-button:hover {
            background-color: #45a049;
        }

        .roll-button:active {
            transform: translateY(2px);
            border-bottom-width: 2px;
        }

        .roll-button:disabled {
            background-color: #666666;
            border-bottom-color: #444444;
            cursor: not-allowed;
        }

        .inventory {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .emoji-item {
            background-color: #444455;
            border: 2px solid #5a5a6a;
            padding: 5px;
            text-align: center;
            position: relative;
            cursor: pointer;
            transition: all 0.2s;
        }

        .emoji-item:hover {
            background-color: #555566;
            transform: translateY(-2px);
        }

        .emoji-icon {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .emoji-rarity {
            font-size: 10px;
            color: #aaa;
        }

        .emoji-value {
            font-size: 12px;
            color: #ffcc00;
        }

        .upgrades {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .upgrade {
            background-color: #444455;
            border: 2px solid #5a5a6a;
            padding: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .upgrade:hover {
            background-color: #555566;
            border-color: #6a6a7a;
        }

        .upgrade-purchased {
            background-color: #334433;
            border-color: #445544;
        }

        .upgrade-title {
            font-weight: bold;
            color: #ffcc00;
            margin-bottom: 5px;
        }

        .upgrade-desc {
            font-size: 12px;
            color: #aaa;
            margin-bottom: 5px;
        }

        .upgrade-cost {
            font-size: 14px;
            color: #4CAF50;
        }

        .rarity-common {
            color: #ffffff;
        }

        .rarity-uncommon {
            color: #55ff55;
        }

        .rarity-rare {
            color: #5555ff;
        }

        .rarity-epic {
            color: #aa55ff;
        }

        .rarity-legendary {
            color: #ffaa00;
        }

        .rarity-mythic {
            color: #ff55ff;
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .notification.show {
            opacity: 1;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .float {
            animation: float 2s infinite;
        }

        .pixel-border {
            border-style: solid;
            border-width: 4px;
            border-image: repeating-linear-gradient(45deg, #4a4a6a, #4a4a6a 2px, #3a3a5a 2px, #3a3a5a 4px) 4;
        }
    </style>
</head>
<body>
    <div class="container pixel-border">
        <h1>PIXEL BOX ROLLER</h1>
        
        <div class="stats-bar pixel-border">
            <div class="stat">
                <div class="stat-icon">üí∞</div>
                <div id="cash">$0</div>
            </div>
            <div class="stat">
                <div class="stat-icon">üéÅ</div>
                <div id="rolls">2 rolls</div>
            </div>
            <div class="stat">
                <div class="stat-icon">üçÄ</div>
                <div id="luck">1.0x luck</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="roll-section pixel-border">
                <h2>Roll Box</h2>
                <div class="box" id="box">‚ùì</div>
                <button class="roll-button" id="roll-button">ROLL (Cost: 0)</button>
                <div id="last-roll"></div>
            </div>
            
            <div class="inventory-section pixel-border">
                <h2>Inventory <span id="inventory-count">(0)</span></h2>
                <div class="inventory" id="inventory"></div>
            </div>
            
            <div class="upgrades-section pixel-border">
                <h2>Upgrades</h2>
                <div class="upgrades" id="upgrades"></div>
            </div>
        </div>
    </div>
    
    <div class="notification" id="notification"></div>

    <script>
        // Game state
        const state = {
            cash: 0,
            rolls: 2,
            maxRolls: 2,
            luck: 1.0,
            inventory: [],
            autoRollInterval: null,
            lastRoll: null,
            upgrades: {
                betterOdds1: { name: "Lucky Charm", desc: "Slightly increase luck (+0.2x)", cost: 50, purchased: false, effect: () => { state.luck += 0.2; updateLuckDisplay(); } },
                betterOdds2: { name: "Four-Leaf Clover", desc: "Increase luck (+0.3x)", cost: 150, purchased: false, effect: () => { state.luck += 0.3; updateLuckDisplay(); } },
                betterOdds3: { name: "Rabbit's Foot", desc: "Greatly increase luck (+0.5x)", cost: 400, purchased: false, effect: () => { state.luck += 0.5; updateLuckDisplay(); } },
                betterOdds4: { name: "Horseshoe", desc: "Massively increase luck (+1.0x)", cost: 1000, purchased: false, effect: () => { state.luck += 1.0; updateLuckDisplay(); } },
                moreRolls1: { name: "Extra Pocket", desc: "Increase max rolls by 1", cost: 100, purchased: false, effect: () => { state.maxRolls += 1; updateRollsDisplay(); } },
                moreRolls2: { name: "Bigger Pockets", desc: "Increase max rolls by 2", cost: 300, purchased: false, effect: () => { state.maxRolls += 2; updateRollsDisplay(); } },
                autoRoll1: { name: "Auto Roller", desc: "Get 1 free roll every 2 minutes", cost: 200, purchased: false, effect: () => { startAutoRoll(120000); } },
                autoRoll2: { name: "Better Auto Roller", desc: "Get 1 free roll every minute", cost: 500, purchased: false, effect: () => { startAutoRoll(60000); } },
                autoRoll3: { name: "Premium Auto Roller", desc: "Get 2 free rolls every minute", cost: 1200, purchased: false, effect: () => { startAutoRoll(30000); } },
                sellMulti1: { name: "Haggling 101", desc: "Get 10% more when selling", cost: 250, purchased: false, effect: () => {} },
                sellMulti2: { name: "Master Negotiator", desc: "Get 25% more when selling", cost: 600, purchased: false, effect: () => {} },
                rollDiscount1: { name: "Membership Card", desc: "Rolls cost 1 less", cost: 350, purchased: false, effect: () => {} },
                rollDiscount2: { name: "VIP Pass", desc: "Rolls cost 2 less", cost: 800, purchased: false, effect: () => {} },
                inventorySpace1: { name: "Backpack", desc: "Double inventory space", cost: 150, purchased: false, effect: () => {} },
                inventorySpace2: { name: "Storage Unit", desc: "Triple inventory space", cost: 400, purchased: false, effect: () => {} }
            }
        };

        // Emoji data with rarities and values
        const emojis = [
            // Common (60% chance)
            { emoji: "üçé", name: "Apple", rarity: "common", value: 5 },
            { emoji: "üçû", name: "Bread", rarity: "common", value: 5 },
            { emoji: "ü•õ", name: "Milk", rarity: "common", value: 5 },
            { emoji: "üç≠", name: "Lollipop", rarity: "common", value: 5 },
            { emoji: "üç™", name: "Cookie", rarity: "common", value: 5 },
            
            // Uncommon (25% chance)
            { emoji: "üçï", name: "Pizza", rarity: "uncommon", value: 15 },
            { emoji: "üçî", name: "Hamburger", rarity: "uncommon", value: 15 },
            { emoji: "üç©", name: "Donut", rarity: "uncommon", value: 15 },
            { emoji: "üç£", name: "Sushi", rarity: "uncommon", value: 15 },
            { emoji: "üç´", name: "Chocolate", rarity: "uncommon", value: 15 },
            
            // Rare (10% chance)
            { emoji: "üéÆ", name: "Game Controller", rarity: "rare", value: 40 },
            { emoji: "üì±", name: "Smartphone", rarity: "rare", value: 40 },
            { emoji: "üíé", name: "Gem Stone", rarity: "rare", value: 40 },
            { emoji: "üé∏", name: "Guitar", rarity: "rare", value: 40 },
            { emoji: "üëë", name: "Crown", rarity: "rare", value: 40 },
            
            // Epic (4% chance)
            { emoji: "üöó", name: "Car", rarity: "epic", value: 100 },
            { emoji: "üè†", name: "House", rarity: "epic", value: 100 },
            { emoji: "üõ©Ô∏è", name: "Airplane", rarity: "epic", value: 100 },
            { emoji: "‚öîÔ∏è", name: "Sword", rarity: "epic", value: 100 },
            { emoji: "üèÜ", name: "Trophy", rarity: "epic", value: 100 },
            
            // Legendary (0.9% chance)
            { emoji: "üêâ", name: "Dragon", rarity: "legendary", value: 500 },
            { emoji: "ü¶Ñ", name: "Unicorn", rarity: "legendary", value: 500 },
            { emoji: "üëΩ", name: "Alien", rarity: "legendary", value: 500 },
            { emoji: "üåà", name: "Rainbow", rarity: "legendary", value: 500 },
            { emoji: "üåã", name: "Volcano", rarity: "legendary", value: 500 },
            
            // Mythic (0.1% chance)
            { emoji: "üåå", name: "Galaxy", rarity: "mythic", value: 2500 },
            { emoji: "üï≥Ô∏è", name: "Black Hole", rarity: "mythic", value: 2500 },
            { emoji: "üßø", name: "All-Seeing Eye", rarity: "mythic", value: 2500 },
            { emoji: "‚òØÔ∏è", name: "Yin Yang", rarity: "mythic", value: 2500 },
            { emoji: "‚öõÔ∏è", name: "Atom", rarity: "mythic", value: 2500 }
        ];

        // DOM elements
        const cashDisplay = document.getElementById('cash');
        const rollsDisplay = document.getElementById('rolls');
        const luckDisplay = document.getElementById('luck');
        const boxElement = document.getElementById('box');
        const rollButton = document.getElementById('roll-button');
        const inventoryElement = document.getElementById('inventory');
        const inventoryCount = document.getElementById('inventory-count');
        const upgradesElement = document.getElementById('upgrades');
        const lastRollDisplay = document.getElementById('last-roll');
        const notification = document.getElementById('notification');

        // Initialize the game
        function init() {
            updateCashDisplay();
            updateRollsDisplay();
            updateLuckDisplay();
            renderUpgrades();
            
            // Load saved game if available
            const savedGame = localStorage.getItem('pixelBoxRollerSave');
            if (savedGame) {
                const parsed = JSON.parse(savedGame);
                Object.assign(state, parsed);
                updateAllDisplays();
                renderInventory();
            }
            
            // Start passive roll generation
            startAutoRoll(60000);
            
            // Set up event listeners
            rollButton.addEventListener('click', rollBox);
            
            // Set up auto-save
            setInterval(saveGame, 10000);
        }

        // Update all displays
        function updateAllDisplays() {
            updateCashDisplay();
            updateRollsDisplay();
            updateLuckDisplay();
            renderInventory();
        }

        // Update cash display
        function updateCashDisplay() {
            cashDisplay.textContent = `$${state.cash}`;
        }

        // Update rolls display
        function updateRollsDisplay() {
            rollsDisplay.textContent = `${state.rolls}/${state.maxRolls} rolls`;
            rollButton.textContent = `ROLL (Cost: ${getRollCost()})`;
            rollButton.disabled = state.rolls <= 0;
        }

        // Update luck display
        function updateLuckDisplay() {
            luckDisplay.textContent = `${state.luck.toFixed(1)}x luck`;
        }

        // Get current roll cost
        function getRollCost() {
            let cost = 0;
            if (state.upgrades.rollDiscount1.purchased) cost -= 1;
            if (state.upgrades.rollDiscount2.purchased) cost -= 1;
            return Math.max(0, cost);
        }

        // Roll the box for an emoji
        function rollBox() {
            if (state.rolls <= 0) return;
            
            state.rolls--;
            updateRollsDisplay();
            
            // Animate the box
            boxElement.classList.add('shake');
            boxElement.textContent = "‚ùì";
            
            setTimeout(() => {
                boxElement.classList.remove('shake');
                
                // Calculate roll with luck
                let roll = Math.random() * 100;
                roll = Math.min(99.9, roll / state.luck); // Higher luck makes better rolls more likely
                
                // Determine rarity
                let rarity;
                if (roll < 60) rarity = "common";
                else if (roll < 85) rarity = "uncommon";
                else if (roll < 95) rarity = "rare";
                else if (roll < 99) rarity = "epic";
                else if (roll < 99.9) rarity = "legendary";
                else rarity = "mythic";
                
                // Filter emojis by rarity and pick one
                const possibleEmojis = emojis.filter(e => e.rarity === rarity);
                const rolledEmoji = possibleEmojis[Math.floor(Math.random() * possibleEmojis.length)];
                
                // Add to inventory
                state.inventory.push(rolledEmoji);
                state.lastRoll = rolledEmoji;
                
                // Update display
                boxElement.textContent = rolledEmoji.emoji;
                lastRollDisplay.innerHTML = `You got: <span class="rarity-${rolledEmoji.rarity}">${rolledEmoji.emoji} ${rolledEmoji.name} (${rolledEmoji.rarity})</span>`;
                
                // Show notification
                showNotification(`Got ${rolledEmoji.emoji} ${rolledEmoji.name} (${rolledEmoji.rarity})`, rolledEmoji.rarity);
                
                // Update inventory
                renderInventory();
                
            }, 500);
        }

        // Render inventory
        function renderInventory() {
            inventoryElement.innerHTML = '';
            inventoryCount.textContent = `(${state.inventory.length})`;
            
            state.inventory.forEach((item, index) => {
                const itemElement = document.createElement('div');
                itemElement.className = 'emoji-item';
                itemElement.innerHTML = `
                    <div class="emoji-icon">${item.emoji}</div>
                    <div class="emoji-rarity rarity-${item.rarity}">${item.rarity}</div>
                    <div class="emoji-value">$${getSellValue(item)}</div>
                `;
                
                itemElement.addEventListener('click', () => sellItem(index));
                inventoryElement.appendChild(itemElement);
            });
        }

        // Get sell value for an item
        function getSellValue(item) {
            let value = item.value;
            if (state.upgrades.sellMulti1.purchased) value *= 1.1;
            if (state.upgrades.sellMulti2.purchased) value *= 1.25;
            return Math.floor(value);
        }

        // Sell an item
        function sellItem(index) {
            const item = state.inventory[index];
            const value = getSellValue(item);
            
            state.cash += value;
            state.inventory.splice(index, 1);
            
            updateCashDisplay();
            renderInventory();
            
            showNotification(`Sold ${item.emoji} for $${value}`, "sell");
        }

        // Render upgrades
        function renderUpgrades() {
            upgradesElement.innerHTML = '';
            
            for (const [id, upgrade] of Object.entries(state.upgrades)) {
                const upgradeElement = document.createElement('div');
                upgradeElement.className = `upgrade ${upgrade.purchased ? 'upgrade-purchased' : ''}`;
                upgradeElement.innerHTML = `
                    <div class="upgrade-title">${upgrade.name}</div>
                    <div class="upgrade-desc">${upgrade.desc}</div>
                    <div class="upgrade-cost">$${upgrade.cost}</div>
                `;
                
                if (!upgrade.purchased) {
                    upgradeElement.addEventListener('click', () => purchaseUpgrade(id));
                }
                
                upgradesElement.appendChild(upgradeElement);
            }
        }

        // Purchase an upgrade
        function purchaseUpgrade(id) {
            const upgrade = state.upgrades[id];
            
            if (state.cash >= upgrade.cost && !upgrade.purchased) {
                state.cash -= upgrade.cost;
                upgrade.purchased = true;
                upgrade.effect();
                
                updateCashDisplay();
                renderUpgrades();
                
                showNotification(`Purchased ${upgrade.name}!`, "upgrade");
            } else if (!upgrade.purchased) {
                showNotification("Not enough cash!", "error");
            }
        }

        // Show notification
        function showNotification(message, type) {
            notification.textContent = message;
            notification.className = 'notification';
            
            // Set color based on type
            if (type === "common") notification.style.color = "#ffffff";
            else if (type === "uncommon") notification.style.color = "#55ff55";
            else if (type === "rare") notification.style.color = "#5555ff";
            else if (type === "epic") notification.style.color = "#aa55ff";
            else if (type === "legendary") notification.style.color = "#ffaa00";
            else if (type === "mythic") notification.style.color = "#ff55ff";
            else if (type === "sell") notification.style.color = "#ffcc00";
            else if (type === "upgrade") notification.style.color = "#4CAF50";
            else if (type === "error") notification.style.color = "#ff5555";
            
            // Show and hide
            setTimeout(() => {
                notification.classList.add('show');
                setTimeout(() => {
                    notification.classList.remove('show');
                }, 3000);
            }, 10);
        }

        // Start auto roll generation
        function startAutoRoll(interval) {
            if (state.autoRollInterval) {
                clearInterval(state.autoRollInterval);
            }
            
            state.autoRollInterval = setInterval(() => {
                if (state.rolls < state.maxRolls) {
                    state.rolls++;
                    updateRollsDisplay();
                    showNotification("Free roll added!", "upgrade");
                }
            }, interval);
        }

        // Save game state
        function saveGame() {
            localStorage.setItem('pixelBoxRollerSave', JSON.stringify({
                cash: state.cash,
                rolls: state.rolls,
                maxRolls: state.maxRolls,
                luck: state.luck,
                inventory: state.inventory,
                upgrades: state.upgrades
            }));
        }

        // Initialize the game when loaded
        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>